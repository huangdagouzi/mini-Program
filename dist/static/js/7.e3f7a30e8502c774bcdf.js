webpackJsonp([7],{MARN:function(e,t){},P7ry:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o("cXVZ"),i={data:function(){var e=this;return{checked:!1,ruleForm:{username:"",password:""},forgetPwdVisible:!1,bindingDialog:!1,forgetPwdData:{phone:"",code:"",newPwd:"",newPwdConfirm:""},bindForm:{username:"",phone:"",code:"",btntxt:"获取验证码",disabled:!1,time:0},btntxt:"获取验证码",disabled:!1,time:0,rules:{phone:[{required:!0,message:"请输入手机号",trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"}],newPwd:[{required:!0,validator:function(t,o,r){""===o?r(new Error("请输入密码")):(""!==e.forgetPwdData.newPwdConfirm&&e.$refs.form.validateField("newPwdConfirm"),r())},trigger:"blur"}],newPwdConfirm:[{required:!0,validator:function(t,o,r){""===o?r(new Error("请再次输入密码")):o!==e.forgetPwdData.newPwd?r(new Error("两次输入的密码不一致")):r()},trigger:"blur"}]}}},mounted:function(){this.getUsername()},methods:{login:function(e){var t=this;this.checked&&localStorage.setItem("username",this.ruleForm.username),this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var o={username:t.ruleForm.username,password:t.ruleForm.password};t.axios.post(r.p,t.$qs.stringify(o),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){localStorage.setItem("aide_username",e.data.resData.userName),t.bindForm.userId=e.data.resData.id,e.data.resData.mobile?t.$router.push("/"):(t.bindingDialog=!0,t.bindForm.username=localStorage.getItem("aide_username"))}).catch(function(e){console.log(e)})})},sendcode:function(){var e=this,t={phone:this.forgetPwdData.phone,smsType:"forget"};this.time=60,this.disabled=!0,this.timer(),this.axios.post(r.q,t).then(function(t){200==t.data.resCode?e.$message({message:t.data.resMsg,type:"success"}):e.$message.error(t.data.resMsg)}).catch(function(e){console.log(e)})},timer:function(){this.time>0?(this.time--,this.btntxt=this.time+"s",setTimeout(this.timer,1e3)):(this.time=0,this.btntxt="获取验证码",this.disabled=!1)},bindsendcode:function(){var e=this,t={phone:this.bindForm.phone,smsType:"register"};this.bindForm.time=60,this.bindForm.disabled=!0,this.bindtimer(),this.axios.post(r.q,t).then(function(t){200==t.data.resCode?e.$message({message:t.data.resMsg,type:"success"}):e.$message.error(t.data.resMsg)}).catch(function(e){console.log(e)})},bindtimer:function(){this.bindForm.time>0?(this.bindForm.time--,this.bindForm.btntxt=this.bindForm.time+"s",setTimeout(this.bindtimer,1e3)):(this.bindForm.time=0,this.bindForm.btntxt="获取验证码",this.bindForm.disabled=!1)},onSubmit:function(){this.$refs.form.validate(function(e){if(!e)return console.log("error submit!!"),!1;console.log("success")})},findPwd:function(){this.forgetPwdVisible=!0},getUsername:function(){this.ruleForm.username=localStorage.getItem("aide_username")},bindFormSubmit:function(){var e=this;this.$refs.bindForm.validate(function(t){if(!t)return console.log("error submit!!"),!1;var o={phone:e.bindForm.phone,smsType:"register",code:e.bindForm.code,userId:e.bindForm.userId};e.axios.post(r.s,e.$qs.stringify(o)).then(function(t){200==t.data.resCode?e.$router.push("/"):e.$message.error(t.data.resMsg)}).catch(function(e){console.log(e)})})}}},s={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"login-wrap"},[o("div",{staticClass:"ms-login"},[o("div",{staticClass:"ms-title"},[e._v("仓单业务风险管理系统")]),e._v(" "),o("el-form",{ref:"ruleForm",staticClass:"ms-content",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"0px"}},[o("el-form-item",{attrs:{prop:"username"}},[o("el-input",{attrs:{placeholder:"用户名"},on:{change:function(t){e.ruleForm.username=t}},model:{value:e.ruleForm.username,callback:function(t){e.$set(e.ruleForm,"username",t)},expression:"ruleForm.username"}},[o("el-button",{attrs:{slot:"prepend",icon:"el-icon-all-user"},slot:"prepend"})],1)],1),e._v(" "),o("el-form-item",{attrs:{prop:"password"}},[o("el-input",{attrs:{type:"password",placeholder:"密码"},on:{change:function(t){e.ruleForm.password=t}},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.login("ruleForm")}},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}},[o("el-button",{attrs:{slot:"prepend",icon:"el-icon-all-password"},slot:"prepend"})],1)],1),e._v(" "),o("div",{staticClass:"login-select"},[o("el-checkbox",{staticStyle:{color:"#a0a0a0"},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("记住帐户")]),e._v(" "),o("span",{staticClass:"forgetPwd",on:{click:e.findPwd}},[e._v("忘记密码")])],1),e._v(" "),o("div",{staticClass:"login-btn"},[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.login("ruleForm")}}},[e._v("登录")])],1),e._v(" "),o("p",{staticClass:"login-tips"},[e._v("Tips : 请输入用户名和密码。")])],1),e._v(" "),o("el-dialog",{attrs:{title:"忘记密码",visible:e.forgetPwdVisible,width:"300px"},on:{"update:visible":function(t){e.forgetPwdVisible=t}}},[o("el-form",{ref:"form",attrs:{model:e.forgetPwdData,rules:e.rules,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[o("el-input",{attrs:{type:"text"},model:{value:e.forgetPwdData.phone,callback:function(t){e.$set(e.forgetPwdData,"phone","string"==typeof t?t.trim():t)},expression:"forgetPwdData.phone"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"验证码",prop:"code",width:"30%"}},[o("el-input",{staticStyle:{width:"80px"},attrs:{type:"text"},model:{value:e.forgetPwdData.code,callback:function(t){e.$set(e.forgetPwdData,"code","string"==typeof t?t.trim():t)},expression:"forgetPwdData.code"}}),e._v(" "),o("el-button",{attrs:{disabled:e.disabled},on:{click:e.sendcode}},[e._v(e._s(e.btntxt))])],1),e._v(" "),o("el-form-item",{attrs:{label:"新密码",prop:"newPwd"}},[o("el-input",{attrs:{type:"password"},model:{value:e.forgetPwdData.newPwd,callback:function(t){e.$set(e.forgetPwdData,"newPwd","string"==typeof t?t.trim():t)},expression:"forgetPwdData.newPwd"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"确认密码",prop:"newPwdConfirm"}},[o("el-input",{attrs:{type:"password",placeholder:"请重复新密码"},model:{value:e.forgetPwdData.newPwdConfirm,callback:function(t){e.$set(e.forgetPwdData,"newPwdConfirm","string"==typeof t?t.trim():t)},expression:"forgetPwdData.newPwdConfirm"}})],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.forgetPwdVisible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{attrs:{title:"绑定手机",visible:e.bindingDialog,width:"300px"},on:{"update:visible":function(t){e.bindingDialog=t}}},[o("el-form",{ref:"bindForm",attrs:{model:e.bindForm,rules:e.rules,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[o("el-input",{attrs:{type:"text"},model:{value:e.bindForm.phone,callback:function(t){e.$set(e.bindForm,"phone","string"==typeof t?t.trim():t)},expression:"bindForm.phone"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"验证码",prop:"code",width:"30%"}},[o("el-input",{staticStyle:{width:"80px"},attrs:{type:"text"},model:{value:e.bindForm.code,callback:function(t){e.$set(e.bindForm,"code","string"==typeof t?t.trim():t)},expression:"bindForm.code"}}),e._v(" "),o("el-button",{attrs:{disabled:e.bindForm.disabled},on:{click:e.bindsendcode}},[e._v(e._s(e.bindForm.btntxt))])],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.bindingDialog=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.bindFormSubmit}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var n=o("VU/8")(i,s,!1,function(e){o("MARN")},"data-v-7ccbe3ca",null);t.default=n.exports}});
//# sourceMappingURL=7.e3f7a30e8502c774bcdf.js.map